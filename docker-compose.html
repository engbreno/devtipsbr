<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Docker Compose - DevTipsBR</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="section-filter.css">
</head>
<body>
    <div class="container-fluid bg-modern min-vh-100 py-4">
        <div class="container">
            <a href="index.html" class="btn btn-secondary mb-4">
                <i class="bi bi-arrow-left"></i> Voltar
            </a>
            
            <div class="content-card">
                <div class="content-header">
                    <h1>
                        <img src="https://raw.githubusercontent.com/docker/compose/master/logo.png" alt="Docker Compose" style="width: 40px; height: auto;" class="me-2">
                        Docker Compose - Comandos Essenciais üêô
                    </h1>
                </div>
                
                <div class="filter-box">
                    <div class="d-flex align-items-center">
                        <div class="flex-grow-1">
                            <label for="sectionSelector" class="form-label">Selecione uma se√ß√£o:</label>
                            <select class="form-select" id="sectionSelector">
                                <option value="all">Todas as se√ß√µes</option>
                                <option value="comandos">Comandos B√°sicos</option>
                                <option value="configuracao">Configura√ß√£o do Docker Compose</option>
                                <option value="redes">Redes e Comunica√ß√£o</option>
                                <option value="volumes">Volumes e Dados</option>
                                <option value="exemplos">Exemplos Pr√°ticos</option>
                                <option value="dicas">Dicas √öteis</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="content-body">
                    <!-- Se√ß√£o: Comandos B√°sicos -->
                    <div id="comandos" class="section-content active">
                        <h2>Comandos B√°sicos üîÑ</h2>
                        
                        <h3>Gerenciamento de Servi√ßos</h3>
                        <pre><code># Criar e iniciar containers
docker-compose up

# Iniciar em segundo plano
docker-compose up -d

# Parar servi√ßos
docker-compose stop

# Parar e remover containers, redes e volumes
docker-compose down

# Parar e remover tudo, incluindo imagens
docker-compose down --rmi all

# Reconstruir servi√ßos
docker-compose up --build

# Iniciar servi√ßos espec√≠ficos
docker-compose up -d nginx mysql</code></pre>
                        
                        <h3>Logs e Monitoramento</h3>
                        <pre><code># Ver logs de todos os servi√ßos
docker-compose logs

# Ver logs em tempo real
docker-compose logs -f

# Ver logs de servi√ßos espec√≠ficos
docker-compose logs nginx

# Ver logs com timestamps
docker-compose logs --timestamps

# Limitar quantidade de linhas
docker-compose logs --tail=100</code></pre>
                    </div>
                    
                    <!-- Se√ß√£o: Configura√ß√£o do Docker Compose -->
                    <div id="configuracao" class="section-content active">
                        <h2>Configura√ß√£o do Docker Compose üìù</h2>
                        
                        <h3>Estrutura do arquivo docker-compose.yml</h3>
                        <pre><code>version: '3'  # Vers√£o do formato

services:      # Defini√ß√£o dos servi√ßos
  webapp:      # Nome do servi√ßo
    image: nginx:latest  # Imagem a ser usada
    container_name: meu-webapp  # Nome do container
    ports:
      - "80:80"  # Mapeamento de portas (host:container)
    volumes:
      - ./html:/usr/share/nginx/html  # Mapeamento de volume
    environment:  # Vari√°veis de ambiente
      - NGINX_HOST=example.com
    restart: always  # Pol√≠tica de rein√≠cio</code></pre>
                        
                        <h3>Op√ß√µes comuns de servi√ßos</h3>
                        <pre><code># Construir a partir de um Dockerfile
build:
  context: ./app  # Contexto do build
  dockerfile: Dockerfile.dev  # Dockerfile personalizado
  args:  # Argumentos de build
    APP_VERSION: v1.0

# Depend√™ncias entre servi√ßos
depends_on:
  - db
  - redis

# Restri√ß√µes de recursos
deploy:
  resources:
    limits:
      cpus: '0.5'
      memory: 512M</code></pre>
                    </div>
                    
                    <!-- Se√ß√£o: Redes e Comunica√ß√£o -->
                    <div id="redes" class="section-content active">
                        <h2>Redes e Comunica√ß√£o üåê</h2>
                        
                        <h3>Configura√ß√£o de redes</h3>
                        <pre><code># Definir redes personalizadas
networks:
  frontend:
    driver: bridge  # Driver de rede
  backend:
    driver: bridge

# Conectar servi√ßos a redes
services:
  webapp:
    networks:
      - frontend
  api:
    networks:
      - frontend
      - backend
  db:
    networks:
      - backend</code></pre>
                        
                        <h3>Comunica√ß√£o entre servi√ßos</h3>
                        <pre><code># Servi√ßos podem se comunicar usando o nome do servi√ßo
# Exemplos:
# - No servi√ßo api, pode-se conectar ao db usando "db" como hostname
# - URL de conex√£o: "postgres://user:pass@db:5432/dbname"</code></pre>
                    </div>
                    
                    <!-- Se√ß√£o: Volumes e Dados -->
                    <div id="volumes" class="section-content active">
                        <h2>Volumes e Dados üíæ</h2>
                        
                        <h3>Defini√ß√£o de volumes</h3>
                        <pre><code># Declara√ß√£o de volumes nomeados
volumes:
  db-data:  # Volume nomeado
    external: false  # Se √© externo ou n√£o
  cache:
    driver: local

# Uso em servi√ßos
services:
  db:
    volumes:
      - db-data:/var/lib/postgresql/data  # Volume nomeado
      - ./init:/docker-entrypoint-initdb.d  # Bind mount
      - /tmp/data:/tmp/data  # Caminho absoluto</code></pre>
                        
                        <h3>Tipos de montagem</h3>
                        <pre><code># Bind mounts (mapeia diret√≥rio do host)
volumes:
  - ./config:/app/config

# Volumes nomeados (gerenciados pelo Docker)
volumes:
  - data-volume:/app/data

# Volume tempor√°rio (anonymous volume)
volumes:
  - /app/temp</code></pre>
                    </div>
                    
                    <!-- Se√ß√£o: Exemplos Pr√°ticos -->
                    <div id="exemplos" class="section-content active">
                        <h2>Exemplos Pr√°ticos üß™</h2>
                        
                        <h3>Aplica√ß√£o Web com Banco de Dados</h3>
                        <pre><code>version: '3'

services:
  web:
    image: nginx:alpine
    ports:
      - "80:80"
    volumes:
      - ./www:/usr/share/nginx/html
    depends_on:
      - app
    networks:
      - frontend

  app:
    build: ./app
    environment:
      - DB_HOST=db
      - DB_USER=myuser
      - DB_PASSWORD=mypassword
    depends_on:
      - db
    networks:
      - frontend
      - backend

  db:
    image: mysql:5.7
    environment:
      - MYSQL_ROOT_PASSWORD=rootpassword
      - MYSQL_DATABASE=mydb
      - MYSQL_USER=myuser
      - MYSQL_PASSWORD=mypassword
    volumes:
      - db-data:/var/lib/mysql
    networks:
      - backend

networks:
  frontend:
  backend:

volumes:
  db-data:</code></pre>
                        
                        <h3>Stack de Monitoramento</h3>
                        <pre><code>version: '3'

services:
  prometheus:
    image: prom/prometheus
    ports:
      - "9090:9090"
    volumes:
      - ./prometheus.yml:/etc/prometheus/prometheus.yml
    networks:
      - monitoring

  grafana:
    image: grafana/grafana
    ports:
      - "3000:3000"
    environment:
      - GF_SECURITY_ADMIN_PASSWORD=admin
    volumes:
      - grafana-data:/var/lib/grafana
    depends_on:
      - prometheus
    networks:
      - monitoring

networks:
  monitoring:

volumes:
  grafana-data:</code></pre>
                    </div>
                    
                    <!-- Se√ß√£o: Dicas √öteis -->
                    <div id="dicas" class="section-content active">
                        <h2>Dicas √öteis üí°</h2>
                        
                        <ol>
                            <li>Use vari√°veis de ambiente com arquivo <code>.env</code> para configura√ß√µes espec√≠ficas do ambiente</li>
                            <li>Utilize <code>docker-compose.override.yml</code> para sobrescrever configura√ß√µes em ambientes de desenvolvimento</li>
                            <li>Separe redes frontend e backend para melhor isolamento dos servi√ßos</li>
                            <li>Use a flag <code>--scale</code> para escalar servi√ßos horizontalmente (<code>docker-compose up -d --scale worker=3</code>)</li>
                            <li>Mantenha volumes de dados para persist√™ncia entre recria√ß√µes de containers</li>
                            <li>Defina <code>healthcheck</code> para verificar o status dos servi√ßos</li>
                        </ol>
                        
                        <h3>Exemplo de healthcheck</h3>
                        <pre><code>services:
  webapp:
    image: nginx
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s</code></pre>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="section-filter.js"></script>
</body>
</html> 