<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AWS CLI - DevTipsBR</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container-fluid bg-modern min-vh-100 py-4">
        <div class="container">
            <a href="index.html" class="btn btn-secondary mb-4">
                <i class="bi bi-arrow-left"></i> Voltar
            </a>
            
            <div class="content-card">
                <div class="content-header">
                    <h1>
                        <img src="https://upload.wikimedia.org/wikipedia/commons/9/93/Amazon_Web_Services_Logo.svg" alt="AWS CLI" style="width: 40px; height: auto;" class="me-2">
                        AWS CLI - Comandos Essenciais ‚òÅÔ∏è
                    </h1>
                </div>
                
                <div class="content-body">
                    <h2>Configura√ß√£o Inicial üîß</h2>
                    
                    <h3>Instala√ß√£o e configura√ß√£o</h3>
                    <pre><code># Instalar AWS CLI no Windows
msiexec.exe /i https://awscli.amazonaws.com/AWSCLIV2.msi

# Instalar AWS CLI no Linux
curl "https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip" -o "awscliv2.zip"
unzip awscliv2.zip
sudo ./aws/install

# Instalar AWS CLI no macOS
curl "https://awscli.amazonaws.com/AWSCLIV2.pkg" -o "AWSCLIV2.pkg"
sudo installer -pkg AWSCLIV2.pkg -target /

# Verificar instala√ß√£o
aws --version</code></pre>
                    
                    <h3>Configura√ß√£o de credenciais</h3>
                    <pre><code># Configura√ß√£o b√°sica
aws configure

# Configura√ß√£o com perfil espec√≠fico
aws configure --profile projeto1

# Listar configura√ß√µes
aws configure list
aws configure list --profile projeto1

# Verificar credenciais configuradas
aws sts get-caller-identity

# Usando AWS SSO
aws configure sso
aws sso login</code></pre>
                    
                    <h2>EC2 (Elastic Compute Cloud) üñ•Ô∏è</h2>
                    
                    <h3>Gerenciamento de inst√¢ncias</h3>
                    <pre><code># Listar inst√¢ncias
aws ec2 describe-instances

# Filtrar inst√¢ncias
aws ec2 describe-instances --filters "Name=instance-type,Values=t2.micro"

# Formatando a sa√≠da
aws ec2 describe-instances --query "Reservations[*].Instances[*].{ID:InstanceId,Type:InstanceType,State:State.Name,Name:Tags[?Key=='Name']|[0].Value}" --output table

# Iniciar inst√¢ncia
aws ec2 start-instances --instance-ids i-1234567890abcdef0

# Parar inst√¢ncia
aws ec2 stop-instances --instance-ids i-1234567890abcdef0

# Reiniciar inst√¢ncia
aws ec2 reboot-instances --instance-ids i-1234567890abcdef0

# Encerrar inst√¢ncia (permanentemente)
aws ec2 terminate-instances --instance-ids i-1234567890abcdef0</code></pre>
                    
                    <h3>Cria√ß√£o de inst√¢ncias</h3>
                    <pre><code># Criar uma inst√¢ncia EC2
aws ec2 run-instances \
    --image-id ami-12345678 \
    --count 1 \
    --instance-type t2.micro \
    --key-name minha-chave \
    --security-group-ids sg-12345678 \
    --subnet-id subnet-12345678

# Criar com script de inicializa√ß√£o
aws ec2 run-instances \
    --image-id ami-12345678 \
    --instance-type t2.micro \
    --key-name minha-chave \
    --user-data file://script-inicializacao.sh

# Adicionar tag (nome) √† inst√¢ncia
aws ec2 create-tags \
    --resources i-1234567890abcdef0 \
    --tags Key=Name,Value=ServidorWeb</code></pre>
                    
                    <h3>Security Groups</h3>
                    <pre><code># Listar grupos de seguran√ßa
aws ec2 describe-security-groups

# Criar grupo de seguran√ßa
aws ec2 create-security-group \
    --group-name web-server \
    --description "Regras para servidor web" \
    --vpc-id vpc-12345678

# Adicionar regra para HTTP
aws ec2 authorize-security-group-ingress \
    --group-id sg-12345678 \
    --protocol tcp \
    --port 80 \
    --cidr 0.0.0.0/0

# Adicionar regra para SSH
aws ec2 authorize-security-group-ingress \
    --group-id sg-12345678 \
    --protocol tcp \
    --port 22 \
    --cidr 192.168.1.0/24</code></pre>
                    
                    <h2>S3 (Simple Storage Service) üì¶</h2>
                    
                    <h3>Gerenciamento de buckets</h3>
                    <pre><code># Listar todos os buckets
aws s3 ls

# Criar um bucket
aws s3 mb s3://meu-bucket-unico

# Habilitar versionamento
aws s3api put-bucket-versioning \
    --bucket meu-bucket-unico \
    --versioning-configuration Status=Enabled

# Configurar pol√≠tica de ciclo de vida
aws s3api put-bucket-lifecycle-configuration \
    --bucket meu-bucket-unico \
    --lifecycle-configuration file://lifecycle.json

# Excluir bucket (deve estar vazio)
aws s3 rb s3://meu-bucket-unico

# Excluir bucket e todo seu conte√∫do
aws s3 rb s3://meu-bucket-unico --force</code></pre>
                    
                    <h3>Opera√ß√µes com objetos</h3>
                    <pre><code># Listar objetos em um bucket
aws s3 ls s3://meu-bucket-unico

# Listar objetos recursivamente
aws s3 ls s3://meu-bucket-unico --recursive

# Fazer upload de arquivos
aws s3 cp arquivo.txt s3://meu-bucket-unico/
aws s3 cp ./pasta s3://meu-bucket-unico/pasta --recursive

# Fazer download de arquivos
aws s3 cp s3://meu-bucket-unico/arquivo.txt ./
aws s3 cp s3://meu-bucket-unico/pasta ./ --recursive

# Sincronizar diret√≥rios
aws s3 sync ./local-dir s3://meu-bucket-unico/remote-dir
aws s3 sync s3://meu-bucket-unico/remote-dir ./local-dir

# Mover arquivos
aws s3 mv arquivo.txt s3://meu-bucket-unico/
aws s3 mv s3://meu-bucket-unico/arquivo.txt ./

# Excluir objetos
aws s3 rm s3://meu-bucket-unico/arquivo.txt
aws s3 rm s3://meu-bucket-unico/pasta --recursive</code></pre>
                    
                    <h2>Lambda üîÑ</h2>
                    
                    <h3>Gerenciamento de fun√ß√µes</h3>
                    <pre><code># Listar fun√ß√µes Lambda
aws lambda list-functions

# Obter informa√ß√µes de uma fun√ß√£o
aws lambda get-function --function-name MinhaFuncao

# Invocar fun√ß√£o Lambda
aws lambda invoke \
    --function-name MinhaFuncao \
    --payload '{"key": "value"}' \
    saida.json

# Criar fun√ß√£o Lambda
aws lambda create-function \
    --function-name MinhaFuncao \
    --runtime python3.9 \
    --role arn:aws:iam::123456789012:role/lambda-role \
    --handler lambda_function.handler \
    --zip-file fileb://funcao.zip

# Atualizar c√≥digo de fun√ß√£o Lambda
aws lambda update-function-code \
    --function-name MinhaFuncao \
    --zip-file fileb://funcao.zip

# Atualizar configura√ß√£o de fun√ß√£o Lambda
aws lambda update-function-configuration \
    --function-name MinhaFuncao \
    --timeout 30 \
    --memory-size 256</code></pre>
                    
                    <h2>IAM (Identity and Access Management) üîê</h2>
                    
                    <h3>Usu√°rios e grupos</h3>
                    <pre><code># Listar usu√°rios
aws iam list-users

# Criar usu√°rio
aws iam create-user --user-name joao

# Criar chave de acesso
aws iam create-access-key --user-name joao

# Listar grupos
aws iam list-groups

# Criar grupo
aws iam create-group --group-name Desenvolvedores

# Adicionar usu√°rio ao grupo
aws iam add-user-to-group \
    --user-name joao \
    --group-name Desenvolvedores</code></pre>
                    
                    <h3>Pol√≠ticas e permiss√µes</h3>
                    <pre><code># Listar pol√≠ticas
aws iam list-policies

# Anexar pol√≠tica a um usu√°rio
aws iam attach-user-policy \
    --user-name joao \
    --policy-arn arn:aws:iam::aws:policy/AmazonS3ReadOnlyAccess

# Anexar pol√≠tica a um grupo
aws iam attach-group-policy \
    --group-name Desenvolvedores \
    --policy-arn arn:aws:iam::aws:policy/AmazonEC2ReadOnlyAccess

# Criar pol√≠tica personalizada
aws iam create-policy \
    --policy-name MinhaPol√≠tica \
    --policy-document file://politica.json</code></pre>
                    
                    <h2>CloudWatch üìä</h2>
                    
                    <h3>M√©tricas e alarmes</h3>
                    <pre><code># Listar m√©tricas dispon√≠veis
aws cloudwatch list-metrics

# Listar m√©tricas para um namespace espec√≠fico
aws cloudwatch list-metrics --namespace AWS/EC2

# Obter dados de m√©trica
aws cloudwatch get-metric-data \
    --metric-data-queries file://metrica-query.json \
    --start-time 2023-01-01T00:00:00Z \
    --end-time 2023-01-02T00:00:00Z

# Criar alarme
aws cloudwatch put-metric-alarm \
    --alarm-name cpu-utilization \
    --alarm-description "Alarme quando CPU excede 70%" \
    --metric-name CPUUtilization \
    --namespace AWS/EC2 \
    --statistic Average \
    --period 300 \
    --threshold 70 \
    --comparison-operator GreaterThanThreshold \
    --dimensions "Name=InstanceId,Value=i-1234567890abcdef0" \
    --evaluation-periods 2 \
    --alarm-actions arn:aws:sns:us-east-1:123456789012:my-topic</code></pre>
                    
                    <h3>Logs</h3>
                    <pre><code># Listar grupos de logs
aws logs describe-log-groups

# Listar streams de logs
aws logs describe-log-streams \
    --log-group-name /aws/lambda/MinhaFuncao

# Obter eventos de log
aws logs get-log-events \
    --log-group-name /aws/lambda/MinhaFuncao \
    --log-stream-name 2023/06/01/[$LATEST]12345678

# Criar filtro de m√©tricas
aws logs put-metric-filter \
    --log-group-name /aws/lambda/MinhaFuncao \
    --filter-name ErrorCount \
    --filter-pattern "ERROR" \
    --metric-transformations \
        metricName=ErrorCount,metricNamespace=MyApp,metricValue=1</code></pre>
                    
                    <h2>RDS (Relational Database Service) üóÑÔ∏è</h2>
                    
                    <h3>Gerenciar inst√¢ncias de banco de dados</h3>
                    <pre><code># Listar inst√¢ncias RDS
aws rds describe-db-instances

# Criar inst√¢ncia RDS
aws rds create-db-instance \
    --db-instance-identifier meudb \
    --db-instance-class db.t3.micro \
    --engine mysql \
    --master-username admin \
    --master-user-password Senha123! \
    --allocated-storage 20

# Modificar inst√¢ncia RDS
aws rds modify-db-instance \
    --db-instance-identifier meudb \
    --backup-retention-period 7 \
    --apply-immediately

# Criar snapshot
aws rds create-db-snapshot \
    --db-snapshot-identifier meudb-snapshot \
    --db-instance-identifier meudb

# Restaurar a partir de snapshot
aws rds restore-db-instance-from-db-snapshot \
    --db-instance-identifier meudb-restored \
    --db-snapshot-identifier meudb-snapshot</code></pre>
                    
                    <h2>ECS (Elastic Container Service) üê≥</h2>
                    
                    <h3>Gerenciamento de clusters e servi√ßos</h3>
                    <pre><code># Listar clusters
aws ecs list-clusters

# Criar cluster
aws ecs create-cluster --cluster-name meu-cluster

# Listar defini√ß√µes de tarefas
aws ecs list-task-definitions

# Registrar defini√ß√£o de tarefa
aws ecs register-task-definition \
    --cli-input-json file://task-definition.json

# Listar servi√ßos
aws ecs list-services --cluster meu-cluster

# Criar servi√ßo
aws ecs create-service \
    --cluster meu-cluster \
    --service-name meu-servico \
    --task-definition minha-tarefa:1 \
    --desired-count 2

# Atualizar servi√ßo
aws ecs update-service \
    --cluster meu-cluster \
    --service meu-servico \
    --task-definition minha-tarefa:2 \
    --desired-count 3</code></pre>
                    
                    <h2>CloudFormation üèóÔ∏è</h2>
                    
                    <h3>Gerenciamento de stacks</h3>
                    <pre><code># Listar stacks
aws cloudformation list-stacks

# Criar stack
aws cloudformation create-stack \
    --stack-name minha-stack \
    --template-body file://template.yaml \
    --parameters ParameterKey=KeyName,ParameterValue=minha-chave

# Atualizar stack
aws cloudformation update-stack \
    --stack-name minha-stack \
    --template-body file://template-updated.yaml

# Descrever recursos da stack
aws cloudformation describe-stack-resources \
    --stack-name minha-stack

# Excluir stack
aws cloudformation delete-stack \
    --stack-name minha-stack</code></pre>
                    
                    <h2>Dicas √öteis üí°</h2>
                    
                    <ol>
                        <li>Use <code>--query</code> para filtrar e formatar sa√≠das JSON:</li>
                    </ol>
                    
                    <pre><code># Exemplo com query
aws ec2 describe-instances \
    --query "Reservations[*].Instances[*].{ID:InstanceId,Name:Tags[?Key=='Name']|[0].Value}" \
    --output table</code></pre>
                    
                    <ol start="2">
                        <li>Escolha entre diferentes formatos de sa√≠da:</li>
                    </ol>
                    
                    <pre><code># Formatos dispon√≠veis
aws ec2 describe-instances --output json
aws ec2 describe-instances --output yaml
aws ec2 describe-instances --output text
aws ec2 describe-instances --output table</code></pre>
                    
                    <ol start="3">
                        <li>Utilize perfis para trabalhar com m√∫ltiplas contas:</li>
                    </ol>
                    
                    <pre><code># Usando perfil espec√≠fico
aws s3 ls --profile cliente1
aws ec2 describe-instances --profile desenvolvimento</code></pre>
                    
                    <ol start="4">
                        <li>Ative o comando de autocompletar:</li>
                    </ol>
                    
                    <pre><code># Bash
complete -C aws_completer aws

# Adicione ao .bashrc para persistir
echo "complete -C aws_completer aws" >> ~/.bashrc</code></pre>
                    
                    <ol start="5">
                        <li>Use o par√¢metro <code>--dry-run</code> para simular comandos sem execut√°-los:</li>
                    </ol>
                    
                    <pre><code># Exemplo com dry-run
aws ec2 start-instances --instance-ids i-1234567890abcdef0 --dry-run</code></pre>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html> 